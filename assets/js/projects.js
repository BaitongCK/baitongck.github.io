const projects = [
    {
        pid: 18, 
        modalid: 'ipsModal', 
        title: 'IPS Service', 
        img: [
            {
                num: 1, 
                img: 'assets/img/uobkayhian/web-trading.png', 
            }, 
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'Oracle'
        ], 
        tools: [
            'Visual Studio', 
            'Oracle', 
        ], 
    },
    {
        pid: 17, 
        modalid: 'thaiflightModal', 
        title: 'Thai Flight Info', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/thai-flight/thai-flight.png', 
            }, 
            {
                num: 2, 
                img: 'assets/img/piesoft/thai-flight/thai-flight-about-doa.png', 
            },
            {
                num: 3, 
                img: 'assets/img/piesoft/thai-flight/thai-flight-about-airport.png', 
            },
            {
                num: 4, 
                img: 'assets/img/piesoft/thai-flight/thai-flight-facilities-symbol.png', 
            },
            {
                num: 5, 
                img: 'assets/img/piesoft/thai-flight/thai-flight-facilities.png', 
            },
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'Microsoft SQL Server'
        ], 
        tools: [
            'Visual Studio', 
            'SQL Server Management Studio', 
        ], 
    }, 
    {
        pid: 16, 
        modalid: 'smartsalesModal', 
        title: 'Smart Sales', 
        img: [
            {
                num: 1, 
                img: 'assets/img/uobkayhian/smart-sales.png', 
            }, 
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'Microsoft SQL Server'
        ], 
        tools: [
            'Visual Studio', 
            'SQL Server Management Studio', 
        ], 
    }, 
    {
        pid: 15, 
        modalid: 'tenderModal', 
        title: 'Tender', 
        img: [
            {
                num: 1, 
                img: 'assets/img/uobkayhian/tender.png', 
            }, 
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'Microsoft SQL Server'
        ], 
        tools: [
            'Visual Studio', 
            'SQL Server Management Studio', 
        ], 
    }, 
    {
        pid: 14, 
        modalid: 'roModal', 
        title: 'RO', 
        img: [
            {
                num: 1, 
                img: 'assets/img/uobkayhian/ro.png', 
            }, 
            {
                num: 2, 
                img: 'assets/img/uobkayhian/ro-backoffice.png', 
            }, 
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'Microsoft SQL Server'
        ], 
        tools: [
            'Visual Studio', 
            'SQL Server Management Studio', 
        ], 
    }, 
    {
        pid: 13, 
        modalid: 'webtradingModal', 
        title: 'Web-Trading', 
        img: [
            {
                num: 1, 
                img: 'assets/img/uobkayhian/web-trading.png', 
            }, 
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'Microsoft SQL Server'
        ], 
        tools: [
            'Visual Studio', 
            'SQL Server Management Studio', 
        ], 
    }, 
    {
        pid: 12, 
        modalid: 'alroModal', 
        title: 'Alro-Tracking', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/alro/alro.png', 
            }, 
            {
                num: 2, 
                img: 'assets/img/piesoft/alro/alro-homepage.png', 
            }, 
            {
                num: 3, 
                img: 'assets/img/piesoft/alro/alro-news.png', 
            }, 
            {
                num: 4, 
                img: 'assets/img/piesoft/alro/alro-managenews.png', 
            }, 
            {
                num: 5, 
                img: 'assets/img/piesoft/alro/alro-addnews.png', 
            }, 
            {
                num: 6, 
                img: 'assets/img/piesoft/alro/alro-dashboard.png', 
            }, 
            {
                num: 7, 
                img: 'assets/img/piesoft/alro/alro-report6.png', 
            },
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Develop stored procedure for dashboard.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'Microsoft SQL Server'
        ], 
        tools: [
            'Visual Studio', 
            'DBeaver', 
            'Postman',
        ], 
    }, 
    {
        pid: 11, 
        modalid: 'pangchangModal', 
        title: 'PangChang', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/pangchang/pangchang.png', 
            }, 
            {
                num: 2, 
                img: 'assets/img/piesoft/pangchang/pangchang-listelephanthouse.png', 
            }, 
            {
                num: 3, 
                img: 'assets/img/piesoft/pangchang/pangchang-listelephanthouse2.png', 
            }, 
        ], 
        responsibilities: [
            'Design and develop database followed by requirement.', 
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'MariaDB'
        ], 
        tools: [
            'Visual Studio', 
            'DBeaver', 
            'Postman',
        ], 
    }, 
    {
        pid: 10, 
        modalid: 'doahrModal', 
        title: 'DOA-HR', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/doa-hr/doa-hr.png', 
            }, 
            {
                num: 2, 
                img: 'assets/img/piesoft/doa-hr/welfare2.png', 
            }, 
            {
                num: 3, 
                img: 'assets/img/piesoft/doa-hr/welfare-add.png', 
            }, 
            {
                num: 4, 
                img: 'assets/img/piesoft/doa-hr/welfare-report.png', 
            }, 
            {
                num: 5, 
                img: 'assets/img/piesoft/doa-hr/welfare-summary.png', 
            }, 
            {
                num: 6, 
                img: 'assets/img/piesoft/doa-hr/welfare-setting.png', 
            }, 
            {
                num: 7, 
                img: 'assets/img/piesoft/doa-hr/decoration2.png', 
            },
            {
                num: 8, 
                img: 'assets/img/piesoft/doa-hr/decoration-add.png', 
            },
            {
                num: 9, 
                img: 'assets/img/piesoft/doa-hr/decoration-summary.png', 
            },
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'MariaDB'
        ], 
        tools: [
            'Visual Studio', 
            'DBeaver', 
            'Postman',
        ], 
    }, 
    {
        pid: 9, 
        modalid: 'nsfModal', 
        title: 'NSF', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/nsf/nsf.png', 
            }, 
        ], 
        responsibilities: [
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'Microsoft SQL Server'
        ], 
        tools: [
            'Visual Studio', 
            'DBeaver', 
        ], 
    }, 
    {
        pid: 8, 
        modalid: 'ebudgetModal', 
        title: 'e-Budget', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/ebudget/ebudget.png"', 
            }, 
        ], 
        responsibilities: [
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'Microsoft SQL Server'
        ], 
        tools: [
            'Visual Studio', 
            'DBeaver', 
        ], 
    }, 
    {
        pid: 7, 
        modalid: 'pwaqualityModal', 
        title: 'PWA-Quality', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/pwa-quality/pwaquality.png', 
            }, 
            {
                num: 2, 
                img: 'assets/img/piesoft/pwa-quality/pwaquality-login.png', 
            }, 
            {
                num: 3, 
                img: 'assets/img/piesoft/pwa-quality/pwaquality-homepage.png', 
            }, 
            {
                num: 4, 
                img: 'assets/img/piesoft/pwa-quality/pwaquality-usermange2.png', 
            }, 
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'MariaDB'
        ], 
        tools: [
            'Visual Studio', 
            'DBeaver', 
            'Postman',
        ], 
    }, 
    {
        pid: 6, 
        modalid: 'pwagisModal', 
        title: 'PWA-GIS', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/pwa-gis/pwagis.png', 
            }, 
            {
                num: 2, 
                img: 'assets/img/piesoft/pwa-gis/pwagis-login.png', 
            }, 
            {
                num: 3, 
                img: 'assets/img/piesoft/pwa-gis/pwagis-listvillage.png', 
            }, 
            {
                num: 4, 
                img: 'assets/img/piesoft/pwa-gis/pwagis-usermange2.png', 
            }, 
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'MariaDB'
        ], 
        tools: [
            'Visual Studio', 
            'DBeaver', 
            'Postman',
        ], 
    }, 
    {
        pid: 5, 
        modalid: 'socModal', 
        title: 'SOC-TimeAttendance', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/soc/soc.png', 
            }, 
            {
                num: 2, 
                img: 'assets/img/piesoft/soc/soc-firstpage.png', 
            }, 
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'MariaDB'
        ], 
        tools: [
            'Visual Studio', 
            'DBeaver', 
            'Postman',
        ], 
    }, 
    {
        pid: 4, 
        modalid: 'covid19Modal', 
        title: 'Covid-19', 
        img: [
            {
                num: 1, 
                img: 'assets/img/error/image-empty.png', 
            },
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'MariaDB'
        ], 
        tools: [
            'Visual Studio', 
            'DBeaver', 
            'Postman',
        ], 
    }, 
    {
        pid: 3, 
        modalid: 'linkageModal', 
        title: 'Linkage', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/linkage/linkage.png', 
            }, 
            {
                num: 2, 
                img: 'assets/img/piesoft/linkage/linkage-petition.png', 
            }, 
            {
                num: 3, 
                img: 'assets/img/piesoft/linkage/linkage-petition-add.png', 
            }, 
            {
                num: 4, 
                img: 'assets/img/piesoft/linkage/linkage-petition-detail.png', 
            }, 
            {
                num: 5, 
                img: 'assets/img/piesoft/linkage/linkage-report.png', 
            }, 
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'MariaDB'
        ], 
        tools: [
            'Visual Studio', 
            'DBeaver', 
        ], 
    }, 
    {
        pid: 2, 
        modalid: 'auditModal', 
        title: 'Internal Audit', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/internal-audit/ia.png', 
            }, 
            {
                num: 2, 
                img: 'assets/img/piesoft/internal-audit/ia-homepage.png', 
            }, 
            {
                num: 3, 
                img: 'assets/img/piesoft/internal-audit/ia-riskcriterion-report.png', 
            }, 
            {
                num: 4, 
                img: 'assets/img/piesoft/internal-audit/ia-riskassess-report.png', 
            }, 
            {
                num: 5, 
                img: 'assets/img/piesoft/internal-audit/ia-auditassess-report.png', 
            }, 
            {
                num: 6, 
                img: 'assets/img/piesoft/internal-audit/ia-deptsatisfaction-report.png', 
            }, 
            {
                num: 7, 
                img: 'assets/img/piesoft/internal-audit/ia-selfassess-report.png', 
            },
            {
                num: 8, 
                img: 'assets/img/piesoft/internal-audit/ia-workpapermaster-report.png', 
            },
        ], 
        responsibilities: [
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'Microsoft SQL Server'
        ], 
        tools: [
            'Visual Studio', 
            'SQL Server Management Studio', 
        ], 
    }, 
    {
        pid: 1, 
        modalid: 'accountModal', 
        title: 'Piesoft-Account', 
        img: [
            {
                num: 1, 
                img: 'assets/img/piesoft/piesoft-account/pa.png', 
            }, 
            {
                num: 2, 
                img: 'assets/img/piesoft/piesoft-account/pa-expense-add.png', 
            }, 
            {
                num: 3, 
                img: 'assets/img/piesoft/piesoft-account/pa-expense-detail.png', 
            }, 
            {
                num: 4, 
                img: 'assets/img/piesoft/piesoft-account/pa-login.png', 
            }, 
            {
                num: 5, 
                img: 'assets/img/piesoft/piesoft-account/pa-admin-expense.png', 
            }, 
            {
                num: 6, 
                img: 'assets/img/piesoft/piesoft-account/pa-admin-expense-update.png', 
            }, 
            {
                num: 7, 
                img: 'assets/img/piesoft/piesoft-account/pa-admin-expense-detail.png', 
            }, 
            {
                num: 8, 
                img: 'assets/img/piesoft/piesoft-account/pa-admin-income.png', 
            }, 
            {
                num: 9, 
                img: 'assets/img/piesoft/piesoft-account/pa-admin-income-add.png', 
            }, 
            {
                num: 10, 
                img: 'assets/img/piesoft/piesoft-account/pa-admin-project-add.png', 
            }, 
            {
                num: 11, 
                img: 'assets/img/piesoft/piesoft-account/pa-admin-project-update.png', 
            }, 
            {
                num: 12, 
                img: 'assets/img/piesoft/piesoft-account/pa-admin-summary.png', 
            },
        ], 
        responsibilities: [
            'Design and develop database followed by requirement.', 
            'Develop web application and it can work correctly.', 
            'Testing and maintenance responsibility project application.', 
        ], 
        databases: [
            'Microsoft SQL Server'
        ], 
        tools: [
            'Visual Studio', 
            'SQL Server Management Studio', 
        ], 
    }, 
];

const modal = document.getElementById("modal");
const modalTitle = document.getElementById("modal-title");
const modalImg = document.getElementById("modal-img");
const modalImgDots = document.getElementById("modal-img-dots");
const modalResponsibilities = document.getElementById("ul-responsibilities");
const modalDatabases = document.getElementById("ul-databases");
const modalTools = document.getElementById("ul-tools");
const closeBtn = document.getElementById("btn-close");

async function updateModalContent(projectId) {
    const data = projects.find((item) => item.pid === parseInt(projectId));
    //console.log(projectId);
    //console.log(data);
    if (data) {
      // อัปเดต Title
        modalTitle.textContent = data.title;
    
        // อัปเดต Image
        modalImg.innerHTML = ""; // เคลียร์ข้อมูลเดิม
        modalImgDots.innerHTML = ""; 
        data.img.forEach((resp) => {
            //console.log(resp);

            const divImg = document.createElement("div");
            divImg.className = "slideshow img-fade";

            const div = document.createElement("div");
            div.className = "numtext";
            div.textContent = `${resp.num} / ${data.img.length}`;
            divImg.appendChild(div);

            const img = document.createElement("img");
            img.src = resp.img;
            img.style = "width:100%";
            divImg.appendChild(img);

            modalImg.appendChild(divImg);

            const span = document.createElement("span");
            span.className = "dot";
            span.onclick = () => currentSlide(resp.num, 'modal');
            modalImgDots.appendChild(span);
        });

        // อัปเดต Responsibilities
        modalResponsibilities.innerHTML = ""; // เคลียร์ข้อมูลเดิม
        data.responsibilities.forEach((resp) => {
            const li = document.createElement("li");
            li.textContent = resp;
            modalResponsibilities.appendChild(li);
        });
    
        // อัปเดต Databases
        modalDatabases.innerHTML = ""; // เคลียร์ข้อมูลเดิม
        data.databases.forEach((db) => {
            const li = document.createElement("li");
            li.textContent = db;
            modalDatabases.appendChild(li);
        });
    
        // อัปเดต Tools
        modalTools.innerHTML = ""; // เคลียร์ข้อมูลเดิม
        data.tools.forEach((tool) => {
            const li = document.createElement("li");
            li.textContent = tool;
            modalTools.appendChild(li);
        });
    }
}
  
// เปิด Modal เมื่อคลิกปุ่ม
// document.querySelectorAll(".openModal").forEach((a) => {
//     console.log(a);
//     a.addEventListener("click", (e) => {
//         const projectId = e.target.getAttribute("data-projectid");
//         console.log(projectId);
//         updateModalContent(projectId);
//         modal.style.display = "block"; // แสดง Modal

//         slideIndex = 1;
//         showSlides(slideIndex, "modal");
//     });
// });

document.addEventListener('click', async (e) => {
    const btn = e.target.closest('.openModal'); // ค้นหาองค์ประกอบที่มีคลาส .openModal ใกล้ที่สุด
    if (btn) {
        const projectId = e.target.getAttribute("data-projectid");
        //console.log(projectId);
        await updateModalContent(projectId);


        slideIndex = 1;
        await showSlides(slideIndex, "modal");

        modal.style.display = "block"; // แสดง Modal
    }
});

// ปิด Modal
closeBtn.addEventListener("click", () => {
    modal.style.display = "none"; // ซ่อน Modal
});
  
// ปิด Modal เมื่อคลิกนอกพื้นที่ Modal
window.addEventListener("click", (e) => {
if (e.target === modal) {
    modal.style.display = "none";
}
});

let slideIndex = 1;

// $('#modal').on('shown.bs.modal', function (e) {
//     const projectId = e.target.getAttribute("data-projectid");
//     console.log(projectId);
//     updateModalContent(projectId);

//     slideIndex = 1;
//     showSlides(slideIndex, "modal");
// })

function plusSlides(n, modalId) {
    showSlides(slideIndex += n, modalId);
}
  
function currentSlide(n, modalId) {
    showSlides(slideIndex = n, modalId);
}
  
async function showSlides(n, modalId) {
    let i;
    let modal = document.getElementById(modalId);
    let slides = modal.getElementsByClassName("slideshow");
    let dots = modal.getElementsByClassName("dot");
    if (n > slides.length) {slideIndex = 1}    
    if (n < 1) {slideIndex = slides.length}
    for (i = 0; i < slides.length; i++) {
      slides[i].style.display = "none";  
    }
    for (i = 0; i < dots.length; i++) {
      dots[i].className = dots[i].className.replace(" active", "");
    }
    //console.log(slides);
    //console.log(dots);
    slides[slideIndex - 1].style.display = "block";  
    dots[slideIndex - 1].className += " active";
}